# 射影几何

## 齐次坐标

考虑平面中的直线方程$$ax+by+c=0$$，若令$$l=(a,b,c),p=(x,y,1)$$，则方程可写成向量形式$$l\cdot p=0$$。注意到，对任意实数$$k\neq0$$，$$kl\cdot p=l\cdot kp=0$$表示同一个直线方程。因此我们可以定义$$\mathbb R^3$$上的等价关系，$$(a,b,c)\sim(ka,kb,kc)$$，该等价关系自然导出一个商集，记为$$\mathbb{RP^2}:=\mathbb R^3-\{0\}\setminus \sim=\{(a:b:c)\vert (a,b,c)\sim(ka,kb,kc),k\neq0\}$$，称为**射影平面**，其中$$(a:b:c)$$称为**齐次坐标**。射影平面可以看作嵌入在三维空间$$\mathbb R^3$$中纵坐标$$z=1$$的平面。

![](/assets/projective_geometry1.png)

在齐次坐标下，射影平面中的直线和点都可以用三维向量表示。或者说，一个向量既可以表示一个点，也可以表示一条直线。需要注意，如果一个点$$p_\infty=(x:y:0)$$，则不存在任何实数$$k$$，使得点$$p_\infty$$在平面$$z=1$$上找到对应点。也就是说，点$$p_\infty$$不是经典欧式空平面中的任何一点，但是它存在于射影平面中。现在考虑一个点的运动$$p(t)=(x_0+xt:y_0+yt:1)=(\dfrac{x_0}{t}+x:\dfrac{y_0}{t}+y:\dfrac1t)$$，这是从点$$(x_0:y_0:1)$$起沿方向$$(x,y)$$的匀速直线运动。当$$t\to\infty$$时，$$p(\infty)\to p_\infty=(x:y:0)$$。因此，点$$pp_\infty$$表示了一个在方位$$(x,y)$$的**无穷远点**。同样，直线$$l_\infty=(0:0:c)$$不对应欧式平面中的任何一条直线，但是，对任意无限远点$$p_\infty$$，满足$$l_\infty\cdotp_\infty=0$$，即直线$$l_\infty$$过任意无穷远点，称为**无穷远直线**。无穷远点有无限多个，但是无穷远直线只有一条，穿过所有无穷远点。因此，我们可以说，射影平面就是欧式平面附上一条无穷远直线。

## 对偶性

### 点与直线

我们计算两个不同点$$p,q$$所在的直线，记作$$p \vee q$$，因为点在直线上，我们有$$p\cdot (p \vee q) = q\cdot (p \vee q) = 0$$，这表明$$p,q \perp p \vee q$$。回顾第一节中我们提到，向量$$p\times q$$同时垂直与$$p,q$$，又因为在齐次坐标下系数是无关紧要的，不妨令$$p \vee q=p\times q$$。对于两个无穷远点$$(x_1:y_1:0),(x_2:y_2:0)$$，它们所在直线为$$(x_1,y_1,0)\times(x_2,y_2,0)=(0,0,x_1y_2-x_2y_1)=(0:0:1)$$显然是无穷远直线。

我们再计算两条不同直线$$l,m$$的交点，记作$$l \wedge m$$，同样我们有$$l\cdot (l \wedge m) = m\cdot (l \wedge m) = 0$$，或者$$l,m \perp l\wedge m$$，于是，$$l\wedge m = l\times m$$。如果对于两条平行线$$(a:b:c),(a:b:d)$$，其交点为$$(a,b,c)\times(a,b,d)=(bd-bc,ca-da,0)=(b:-a:0)$$是无穷远点。因此，在射影平面中，两条“平行线”存在唯一交点，或者说，在射影平面中不存在平行线。再计算普通直线$$(a:b:c)$$和无穷远直线$$(0:0:1)$$的交点，得到$$(a,b,c)\times(0,0,1)=(b,-a,0)$$也是无穷远点。

在射影平面中，无穷远点与普通点没有任何区别，无穷远直线与普通直线也没有任何区别，只是为了在我们熟悉的欧式平面中讨论它们才将它们人为地区分开来。所以，在射影平面中，我们可以很方便地处理欧式平面中关于平行线的问题。例如，计算过直线$$l$$外一点$$p$$与该直线平行的平行线，在射影几何中，只需计算$$p\vee(l\wedge l_\infty)=p\times(l\times l_\infty)$$即可。

通过上面的计算，我们发现在射影平面中，点和直线扮演着对偶的角色，我们甚至无法区分，也没有必要区分点和直线。任何一个射影平面中的定理，如果将点和直线的角色互换，则该对偶命题也是一个定理。例如，任意两个不同的点确定唯一一条直线的对偶事实为任意两条直线唯一确定一个点。

### 圆锥曲线

一般地，圆锥曲线是二元二次齐次多项式在射影平面上零点的集合$$\mathcal C:=\{(x:y:z) \in \mathbb {RP}^2 \vert ax^2+by^2+cz^2+2dxy+2eyz+2fzx=0\}$$，若将其投影到平面$$z=1$$，得到$$\mathcal C_{z=1}:=\{(x,y) \in \mathbb R^2 \vert ax^2+by^2+2dxy+2fx+2ey+c=0\}$$。注意到齐次多项式可以写为矩阵形式，

$$\begin{pmatrix}x&y&z\end{pmatrix}\begin{pmatrix}a&d&f\\d&b&e\\f&e&c\end{pmatrix}\begin{pmatrix}x\\y\\z\end{pmatrix}$$

或者，$$\mathcal C:=\{p \in \mathbb {RP}^2 \vert (p,Ap)=0, A=A^T\}$$。我们考虑圆锥曲线与无穷远直线$$l_\infty$$的交点，只需令$$z=0$$，有$$ax^2+by^2+2dxy=\begin{pmatrix}x&y\end{pmatrix}\begin{pmatrix}a&d\\d&b\end{pmatrix}\begin{pmatrix}x\\y\end{pmatrix}=0$$，等式左侧的二次函数有判别式$$\Delta = (2dy)^2-4aby^2=-4y^2\begin{vmatrix}a&d\\d&b\end{vmatrix}$$。因此交点个数，根据行列式的符号，可为$$0、1$$或者$$2$$个，分别对应椭圆、抛物线和双曲线。

![](/assets/projective_geometry2.PNG)

方程$$(p,Ap)=0$$可解释为点$$p$$在直线$$l_T=Ap$$上，我们证明，直线$$l_T$$实际为圆锥曲线在点$$p$$的切线。

**证明**：否则，存在圆锥曲线上另一点$$q$$满足$$(q,Aq)=0$$也在直线$$l_T$$上，即$$(q,l_T)=(q,Ap)=0$$，综上，$$(p-q,A(p-q))=(p,Ap)-(p,Aq)-(q,Ap)+(q,Aq)=-(q,Ap)$$。因为$$A=A^T$$是对称矩阵，有$$(q,Ap)=(A^Tq,p)=(Aq,p)=0$$，故$$(p-q,A(p-q))=0$$，即点$$p-q$$也在该圆锥曲线上。不难证明对于任意$$t\in \mathbb R$$都有$$l:=p(t)=p+t(q-p)$$在该圆锥曲线上。除非圆锥曲线包含一整条直线$$l$$，而对于非退化的圆锥曲线这是不可能的，只能有$$p=q$$。

对偶地，令$$l=Ap$$，如果$$A$$可逆，则方程$$(p,Ap)=(l,A^{-1}l)=0$$是圆锥曲线的切线描述。因此圆锥曲线也可以描述为满足该方程的直线的包络，如图。

![](/assets/projective_geometry3.PNG)

## 射影变换

射影变换是射影平面上的一个可逆线性变换$$L:\mathbb{RP}^2\to\mathbb{RP}^2$$，因此，我们可以用$$3\times3$$的矩阵来表示$$L$$。

考虑三个点$$p,q,r\in\mathbb{RP}^2$$，行列式$$|p\wedge q\wedge r|$$表示了以$$p,q,r$$构成的有向平行六面体的有向体积，简记为$$[pqr]$$。假设三个点都在有限远处，即$$p,q,r\in\mathbb{R}^2$$，并且嵌入到$$\mathbb R^3$$中的$$z=1$$平面上，那么$$[pqr]$$正比于三角形$$\Delta pqr$$的面积，若有$$[pqr]=0$$，则三点$$p,q,r$$共线。不难验证，对于三个无穷远点，关系$$[pqr]=0$$也成立。令另外三点$$p'=Lp,q'=Lq,r'=Lr$$是$$p,q,r$$射影变换后的点，则$$[p'q'r']=|L|[pqr]=0$$也成立。因此，射影变换把共线点映射到共线点。

